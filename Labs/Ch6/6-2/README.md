# Lab Questions
1. What operation does the first subroutine called by main perform?
2. What is the subroutine located at 0x40117F?
3. What does the second subroutine called by main do?
4. What type of code construct is used in this subroutine?
5. Are there any network-based indicators for this program?
6. What is the purpose of this malware?

# Answers
1. It checks to see if there is an internet connection. If there is, it prints that. If there is not, it prints an error message indicating that.
2. This is the printf function. You can tell because of the calls to __stbuf and __ftbuf within and the parameters that get passed to this function. They're strings.
3. It opens the url "http://www.practicalmalwareanalysis.com/cc.htm", reads whatever is on the page, and interprets a command to execute based on what is on that page. If it fails it will print to console and error message indicating where in the process it failed. The command get stored in the lower 8 bits of the eax register.
4. A char array is used here. The information that gets read from the cc page is compared against this array one byte at a time to determine which command to execute.
5. The url requested, ""http://www.practicalmalwareanalysis.com/cc.htm", and the user agent that the malware uses for the request, "Internet Explorer 7.5/pma" are the network signatures.
6. It checks for an internet connection, fails if there isn't one, connects to the URL and parses a command to execute from what's on the page. It then prints this command to console and Sleep()s for 1 minute.