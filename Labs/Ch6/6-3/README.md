# Lab Questions
1. Compare the calls in main to Lab 6-2â€™s main method. What is the new
function called from main?
2. What parameters does this new function take?
3. What major code construct does this function contain?
4. What can this function do?
5. Are there any host-based indicators for this malware?
6. What is the purpose of this malware?
# Answers
1. The new function is sub_401130.
2. The function takes a single character and lpExistingFileName as parameters. lpExistingFileName is just argv which will end up being the name of the program being run.
3. The major code construct is a jump table switch statement with 5 cases excluding default.
4. Based on the switch case, this function can create a temporary directory at C:\Temp, copy an existing cc.exe inside that directory to someplace else, delete files, create a registry key which allows the cc.exe in that temporary directory to run at user login, sleep for 100 seconds, and print various errors to console.
5. The existence of a C:\Temp directory, a cc.exe file in that directory, and a "Malware" registry key in "HKLM\Software\Microsoft\Windows\CurrentVersion\Run" with the data value "C:\Temp\cc.exe" are all host-based indicators.
6. It checks for an internet connection, fails if there isn't one, connects to the URL and parses a command to execute from what's on the page. Based on the contents of the page the program can create a directory, copy a file, delete a file, create a registry key, and sleep for 100 seconds.