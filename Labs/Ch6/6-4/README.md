# Lab Questions
1. What is the difference between the calls made from the main method in
Labs 6-3 and 6-4?
2. What new code construct has been added to main?
3. What is the difference between this labâ€™s parse HTML function and
those of the previous labs?
4. How long will this program run? (Assume that it is connected to the
Internet.)
5. Are there any new network-based indicators for this malware?
6. What is the purpose of this malware?
# Answers
1. The functions have been moved around. 401000 now checks the internet connection, 4012B5 is printf, 401040 now parses the html for the command, and 401150 has the switch statement and handles the registry key creation.
2. A for loop that increments.
3. The user agent string now varies based on the inrement of the for loop in _main as indicated by the '%d' attached to the string the new parameter that the parse function now accepts and uses. sprintf() is used to build this user agent string.
4. The program can run for a maximum of 1440 minutes (24 hours).
5. With the %d attached, the user agent string will now include the amount of time the program has been runnning. Technically this means there are more network based indicators but as long as you just look for something that includes "Internet Explorer 7.5/pma" you'd be able to find it.
6. It checks for an internet connection, fails if there isn't one, connects to the URL with a unique user agent string based on how long the program has been running and parses a command to execute from what's on the page. Based on the contents of the page the program can create a directory, copy a file, delete a file, create a registry key, and sleep for 100 seconds.